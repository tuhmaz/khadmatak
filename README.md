# منصة الخدمات المنزلية الأردنية - خدماتك

## نظرة عامة على المشروع

- **الاسم**: خدماتك - منصة الخدمات المنزلية الأردنية
- **الهدف**: ربط العملاء بمقدمي الخدمات المنزلية المعتمدين في الأردن
- **الميزات الرئيسية**: 
  - تسجيل وإدارة مقدمي الخدمات
  - نظام تحقق متكامل للمزودين
  - واجهة عربية متكاملة (RTL)
  - نظام تقييمات وتقديرات
  - إدارة طلبات الخدمات
  - **ملفات شخصية شاملة للعملاء ومقدمي الخدمات**

## الروابط

- **الإنتاج**: https://3000-i2n4dz157r4ny13hsjf0h-6532622b.e2b.dev
- **الصفحة الرئيسية**: https://3000-i2n4dz157r4ny13hsjf0h-6532622b.e2b.dev
- **لوحة التحكم**: https://3000-i2n4dz157r4ny13hsjf0h-6532622b.e2b.dev/dashboard
- **الملف الشخصي**: https://3000-i2n4dz157r4ny13hsjf0h-6532622b.e2b.dev/profile
- **API الرئيسية**: https://3000-i2n4dz157r4ny13hsjf0h-6532622b.e2b.dev/api/hello
- **GitHub**: سيتم إعداده لاحقاً

## الميزات المضافة حديثاً - الملفات الشخصية

### ✨ صفحات الملف الشخصي الشاملة

#### 👤 ملف العميل
- **المعلومات الأساسية**: الاسم، البريد الإلكتروني، رقم الهاتف، المحافظة، العنوان
- **إحصائيات الحساب**: 
  - إجمالي الطلبات المقدمة
  - الطلبات المكتملة
  - الطلبات قيد التنفيذ
  - مقدمي الخدمات المفضلون
- **النشاط الأخير**: عرض آخر الأنشطة والطلبات
- **إجراءات سريعة**: 
  - طلب خدمة جديدة
  - عرض طلباتي
  - تصفح المفضلين

#### 🛠️ ملف مقدم الخدمة
- **معلومات شخصية**: بيانات المستخدم الأساسية
- **معلومات العمل**: 
  - اسم العمل/الشركة
  - وصف الخدمات
  - سنوات الخبرة
  - الحد الأدنى للتكلفة
  - ساعات وأيام العمل
  - مناطق التغطية
- **الخدمات المقدمة**: إدارة قائمة الخدمات وإضافة جديدة
- **الوثائق والمستندات**: رفع وإدارة وثائق التحقق
- **إحصائيات الأداء**: 
  - إجمالي الطلبات
  - الطلبات المكتملة
  - متوسط التقييم
  - إجمالي الأرباح
- **التقييمات الأخيرة**: عرض تقييمات العملاء
- **حالة التحقق**: عرض حالة اعتماد الحساب (معلق، معتمد، مرفوض)

#### 👨‍💼 ملف المدير
- معلومات المدير الأساسية
- إجراءات سريعة للإدارة
- روابط سريعة للوحة التحكم

### 🔧 API Endpoints للملفات الشخصية

#### GET /api/profile
- جلب بيانات الملف الشخصي حسب نوع المستخدم
- يتضمن الإحصائيات والخدمات للمزودين

#### POST /api/profile/update  
- تحديث بيانات الملف الشخصي
- دعم تحديث الخدمات ومناطق التغطية للمزودين
- التحقق من صحة البيانات

#### GET /api/profile/documents
- جلب وثائق مقدم الخدمة
- عرض حالة التحقق لكل وثيقة

## التنقل المحسن

### 🎯 نقاط الوصول للملف الشخصي
1. **من القائمة الرئيسية**: "الملف الشخصي" في قائمة المستخدم
2. **من لوحة التحكم**: رابط "الملف الشخصي" في الهيدر
3. **التنقل المباشر**: `/profile`

### 🔐 الحماية والمصادقة
- التحقق من تسجيل الدخول قبل عرض الملف الشخصي
- توجيه غير المسجلين لصفحة تسجيل الدخول
- عرض رسالة ودية للمستخدمين غير المصادقين

## هيكلة البيانات والتخزين

### نماذج البيانات الرئيسية

#### جدول المستخدمين (users)
```sql
- id (primary key)
- email (unique)
- password_hash
- name
- phone
- user_type ('customer', 'provider', 'admin')
- city
- address
- birth_date, marital_status ✅ 🔧
- verified (boolean)
- active (boolean)
- created_at, updated_at
```

#### ملفات مقدمي الخدمات (provider_profiles)
```sql
- id (primary key)
- user_id (foreign key)
- business_name
- national_id
- experience_years
- description
- coverage_areas (JSON)
- minimum_charge
- verification_status ('pending', 'approved', 'rejected')
- available (boolean)
- documents_uploaded (boolean)
- average_rating, total_reviews, total_jobs
- work_hours_start, work_hours_end (TEXT) ✅ 🔥
- work_days (JSON) ✅ 🔥
```

#### فئات الخدمات (categories)
```sql
- id (primary key)
- name_ar, name_en
- description_ar, description_en
- icon
- sort_order
- active (boolean)
```

#### وثائق التحقق (provider_documents)
```sql
- id (primary key)
- provider_id (foreign key)
- document_type ('national_id', 'business_license', 'portfolio')
- document_url
- document_name
- file_size
- verification_status ('pending', 'approved', 'rejected')
- verification_notes
- uploaded_at, verified_at
```

### خدمات التخزين المستخدمة
- **Cloudflare D1**: قاعدة بيانات SQLite موزعة عالمياً للبيانات العلائقية
- **المحتوى الثابت**: يتم تقديمه عبر Cloudflare Pages
- **JWT Authentication**: نظام مصادقة آمن مع تشفير الرموز المميزة

### تدفق البيانات
1. **التسجيل**: العميل/المزود ← قاعدة البيانات ← إرسال إشعار للإدارة
2. **التحقق**: الإدارة ← مراجعة الوثائق ← اعتماد/رفض المزود
3. **إدارة الملف الشخصي**: المستخدم ← تحديث البيانات ← حفظ في قاعدة البيانات
4. **الخدمات**: العميل ← طلب خدمة ← تصفية المزودين المناسبين ← إرسال إشعارات

## دليل المستخدم

### للعملاء
1. **التسجيل**: اضغط "انضم كعميل" واملأ البيانات الأساسية
2. **إدارة الملف الشخصي**: 
   - اضغط "الملف الشخصي" من القائمة
   - عدّل معلوماتك الشخصية (الهاتف، العنوان، المحافظة)
   - اطلع على إحصائيات حسابك
3. **طلب خدمة**: اضغط "اطلب خدمة الآن" واختر نوع الخدمة ووصف المشكلة
4. **تصفح المزودين**: استعرض مقدمي الخدمات المعتمدين والمقيمين

### لمقدمي الخدمات
1. **التسجيل**: اضغط "انضم كمزود خدمة" واملأ معلومات العمل والخبرة
2. **إدارة الملف الشخصي الشامل**:
   - **المعلومات الشخصية**: تحديث بيانات الاتصال والعنوان
   - **معلومات العمل**: اسم العمل، الوصف، سنوات الخبرة، الأسعار
   - **الخدمات**: إضافة/حذف الخدمات المقدمة
   - **مناطق التغطية**: تحديد المناطق التي تخدمها
   - **ساعات العمل**: تحديد أيام وساعات العمل
   - **الوثائق**: رفع وإدارة وثائق التحقق
   - **الإحصائيات**: متابعة الأداء والتقييمات
3. **رفع الوثائق**: من تبويب "الوثائق" في الملف الشخصي:
   - بطاقة الهوية الشخصية (ضروري)
   - رخصة مزاولة المهنة (اختياري)
   - صور أعمال سابقة (اختياري)
4. **انتظار الموافقة**: سيتم مراجعة الطلب خلال 24-48 ساعة
5. **بدء العمل**: بعد الموافقة يمكن استقبال طلبات الخدمات

### للإدارة
- مراجعة طلبات التحقق الجديدة
- الموافقة/رفض الوثائق المرفوعة
- إدارة النظام والمستخدمين
- الوصول السريع للوحة التحكم من الملف الشخصي

## الحالة الحالية للتطوير

### ✅ الميزات المكتملة
1. **الواجهة الرئيسية**: 
   - تصميم كامل وعملي مع محتوى ديناميكي
   - عرض فئات الخدمات من قاعدة البيانات
   - عرض مقدمي الخدمات المعتمدين
   - أزرار تسجيل الدخول والتسجيل عاملة

2. **نظام المصادقة**:
   - تسجيل العملاء ومقدمي الخدمات ✅
   - تسجيل الدخول والخروج ✅
   - حماية الطرق بـ JWT ✅
   - واجهة المستخدم التفاعلية (إخفاء/إظهار الأزرار) ✅

3. **الملفات الشخصية الشاملة** 🆕:
   - **ملف العميل**: معلومات شخصية، إحصائيات، نشاط أخير ✅
   - **ملف مقدم الخدمة**: معلومات شاملة مع تبويبات (شخصية، عمل، خدمات، وثائق، إحصائيات) ✅
   - **ملف المدير**: معلومات أساسية مع روابط سريعة ✅
   - **تحديث البيانات**: نظام تعديل شامل مع حفظ في قاعدة البيانات ✅
   - **معلومات العمل**: ساعات العمل وأيام العمل ومناطق التغطية ✅ 🔥
   - **واجهة تفاعلية**: أزرار تعديل/حفظ/إلغاء ✅
   - **حماية المصادقة**: فحص تسجيل الدخول قبل الوصول ✅

4. **APIs الملفات الشخصية**:
   - **GET /api/profile**: جلب البيانات حسب نوع المستخدم ✅
   - **POST /api/profile/update**: تحديث البيانات مع التحقق ✅
   - **GET /api/profile/documents**: جلب وثائق مقدمي الخدمات ✅

5. **إدارة مقدمي الخدمات**:
   - تسجيل مع بيانات مفصلة ✅
   - نظام رفع الوثائق للتحقق ✅
   - إدارة حالات التحقق (معلق، مقبول، مرفوض) ✅
   - لوحة إدارة للمراجعة والاعتماد ✅

6. **قاعدة البيانات**:
   - مخطط كامل مع 8 جداول ✅
   - بيانات تجريبية مع فئات وخدمات ✅
   - نظام الفهرسة للأداء ✅
   - دعم العمليات المتقدمة (transactions, joins) ✅

7. **التصميم والتفاعل**:
   - تصميم متجاوب مع Tailwind CSS ✅
   - دعم اللغة العربية (RTL) كاملاً ✅
   - انيميشنات وتأثيرات تفاعلية ✅
   - رسائل خطأ ونجاح ديناميكية ✅

### 🚧 الميزات قيد التطوير
1. **نظام الطلبات**: إنشاء وإدارة طلبات الخدمات من العملاء
2. **نظام التقييمات**: تقييم مقدمي الخدمات من العملاء
3. **نظام الدفع**: تكامل مع بوابات الدفع الأردنية
4. **الإشعارات**: نظام إشعارات فورية للطلبات والتحديثات
5. **البحث المتقدم**: تصفية وبحث مقدمي الخدمات حسب المعايير
6. **التقارير**: تقارير مفصلة للإدارة والمزودين

### 📱 منطاق التحسينات الموصى بها
1. **تطبيق الهاتف المحمول**: تطوير تطبيق React Native أو Flutter
2. **التكامل مع خرائط Google**: عرض مواقع الخدمات وأقرب المزودين
3. **الذكاء الاصطناعي**: نظام توصيات ذكي لمطابقة العملاء بالمزودين
4. **API خارجي**: تكامل مع خدمات SMS وبريد إلكتروني للإشعارات
5. **رفع الملفات**: تحسين نظام رفع الوثائق مع معاينة وضغط

## التقنيات المستخدمة

### Backend
- **Hono Framework**: إطار عمل سريع وخفيف لـ Cloudflare Workers
- **Cloudflare D1**: قاعدة بيانات SQLite موزعة عالمياً
- **TypeScript**: للكتابة الآمنة والتطوير المحسن
- **Web Crypto API**: للتشفير الآمن (PBKDF2, JWT)
- **Cloudflare Pages**: استضافة وتوزيع المحتوى

### Frontend
- **Vanilla JavaScript**: للتفاعل والديناميكية
- **Tailwind CSS**: للتصميم السريع والمتجاوب
- **Font Awesome**: للأيقونات
- **Axios**: للتواصل مع APIs
- **Cairo Font**: للدعم الأمثل للغة العربية

### التطوير والنشر
- **Vite**: أداة البناء السريعة
- **Wrangler**: أداة تطوير ونشر Cloudflare
- **PM2**: إدارة العمليات أثناء التطوير
- **Git**: نظام إدارة الإصدارات

## إعداد التطوير

```bash
# 1. تثبيت التبعيات
npm install

# 2. تطبيق migrations قاعدة البيانات المحلية
npm run db:migrate:local

# 3. إدخال البيانات التجريبية
npm run db:seed

# 4. بناء المشروع
npm run build

# 5. تشغيل الخادم المحلي
npm run dev:d1

# 6. عبر PM2 (للتطوير المستمر)
pm2 start ecosystem.config.cjs
```

## حالة النشر
- **المنصة**: Cloudflare Pages
- **الحالة**: ✅ نشط ومتاح
- **التقنية**: Hono + TypeScript + D1 + TailwindCSS
- **آخر تحديث**: 28 سبتمبر 2024 - إصلاح أخطاء تحميل البيانات 🔧🔥

## تجربة المستخدم المحسّنة
- **تسجيل الدخول**: يبقى المستخدم في الصفحة الرئيسية بعد تسجيل الدخول
- **رسائل ترحيب**: تخصيص الرسائل حسب نوع المستخدم (عميل/مقدم خدمة)
- **العنوان الرئيسي**: يتم تحديثه ليُظهر اسم المستخدم عند تسجيل الدخول
- **الملف الشخصي**: صفحات شاملة ومفصلة لكل نوع مستخدم
- **التنقل المحسن**: انتقال سلس بين الصفحات مع حفظ حالة المصادقة
- **حفظ حالة المصادقة**: التوكن يُحفظ في الكوكيز و localStorage للوصول المستمر
- **استمرارية الجلسة**: المستخدم يبقى مسجلاً عند التنقل بين الصفحات

## الاختبار والجودة

### اختبارات تم إجراؤها
- ✅ تحميل الصفحة الرئيسية بنجاح
- ✅ عمل APIs للفئات ومقدمي الخدمات  
- ✅ عرض المحتوى الديناميكي صحيح
- ✅ أزرار التسجيل والدخول تعمل
- ✅ نماذج التسجيل تظهر صحيحاً
- ✅ تسجيل الدخول يبقى في الصفحة الرئيسية (لا ينتقل تلقائياً للوحة التحكم)
- ✅ رسائل ترحيب شخصية للمستخدمين المسجلين
- ✅ Navigation متسق بين الصفحات
- ✅ حفظ حالة تسجيل الدخول عند التنقل بين الصفحات
- ✅ **صفحات الملف الشخصي تعمل بنجاح** 🆕
- ✅ **التنقل للملف الشخصي من القائمة** 🆕
- ✅ **التحقق من المصادقة قبل عرض الملف الشخصي** 🆕
- ✅ **عرض محتوى مختلف حسب نوع المستخدم (عميل/مزود/إدارة)** 🆕
- ✅ **APIs الملف الشخصي تعمل بصورة صحيحة** 🆕
- ✅ **معلومات العمل (ساعات وأيام العمل ومناطق التغطية) تُحفظ وتُجلب بنجاح** 🔥
- ✅ **إصلاح أخطاء تحميل البيانات - أخطاء قاعدة البيانات محلولة** 🔧
- ✅ **APIs الملف الشخصي ولوحة التحكم تعمل بنجاح بدون أخطاء** 🔧
- ✅ استجابة الموقع على الشاشات المختلفة
- ✅ دعم اللغة العربية كاملاً

### مؤشرات الأداء
- وقت تحميل الصفحة الرئيسية: ~5.6 ثانية
- وقت تحميل الملف الشخصي: ~9.2 ثانية (يتضمن فحص المصادقة)
- حجم Bundle المضغوط: ~93.52 KB
- دعم المتصفحات: جميع المتصفحات الحديثة
- نسبة الاستجابة: %100

---

*تم إنجاز نظام الملفات الشخصية الشامل بنجاح! الآن يمكن للمستخدمين الوصول إلى صفحات ملف شخصي مفصلة وتفاعلية تتناسب مع نوع حسابهم (عميل، مقدم خدمة، أو مدير) مع إمكانية تعديل وحفظ البيانات.*